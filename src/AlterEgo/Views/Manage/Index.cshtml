@model IndexViewModel
@{
    ViewData["Title"] = "Manage your account";
}

<h2>@ViewData["Title"].</h2>
<p class="text-success">@ViewData["StatusMessage"]</p>

<div class="row">
    <div class="col-lg-12">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>Name</th>
                    <th class="text-center">Race</th>
                    <th class="text-center">Class</th>
                    <th class="text-center">Level</th>
                    <th class="text-center">Realm</th>
                    <th class="text-center">Guild</th>
                    <th class="text-center">Last Modified</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var character in Model.Characters.OrderBy(x => x.Realm).ThenByDescending(x => x.Level).ThenByDescending(x => x.LastModified))
                {
                    var lastModifiedOffset = DateTimeOffset.FromUnixTimeMilliseconds(character.LastModified);
                    var normalizedClassName = $"class-{character.CharacterClass.Name.Replace(' ', '-').ToLower()}";
                    <tr>
                        <td class="@normalizedClassName">@character.Name</td>
                        <td class="text-center"><img src="@Html.Raw($"/images/wow/icons/race_{character.Race}_{character.Gender}.jpg")" alt="@character.CharacterRace.Name" class="img-rounded" /></td>
                        <td class="text-center"><img src="@Html.Raw($"/images/wow/icons/class_{character.Class}.jpg")" alt="@character.CharacterClass.Name" class="img-rounded" /></td>
                        <td class="text-center">@character.Level</td>
                        <td class="text-center">@character.Realm</td>
                        <td class="text-center">@character.Guild</td>
                        <td class="text-center">
                            @if (character.LastModified > 0)
                            {
                                <abbr class="timeago" title="@lastModifiedOffset.DateTime.ToString("O")">@lastModifiedOffset.DateTime.ToString("g")</abbr>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>